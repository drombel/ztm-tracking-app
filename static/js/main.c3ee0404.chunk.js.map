{"version":3,"sources":["utils/query.js","utils/apis.js","components/map/index.js","actions/routes.js","components/models/Buses/Buses.js","router/index.js","views/Main/index.js","views/Buses/index.js","assets/bus-logo.png","components/header/index.js","views/NotFound/index.js","app/App.js","serviceWorker.js","reducers/routesReducer.js","reducers/index.js","stores/index.js","index.js"],"names":["instance","axios","create","baseURL","getBuses","a","query","get","then","response","data","Vehicles","filter","vehicle","GPSQuality","catch","error","console","res","buses","getRoutes","date","Date","toISOString","split","trips","routes","MapContainer","props","useState","id","hidden","selected","setSelected","markers","setMarkers","idField","refresher","useRef","mapMarker","MapSidebarItem","mapSidebarItem","autoUpdate","menu","setMenu","mapRef","bounds","setBounds","zoom","setZoom","fetchData","refreshFunc","newMarkers","length","useEffect","current","setInterval","clearTimeout","Marker","item","MapMarker","closeFunction","Cluster","lat","lng","supercluster","cluster","pointCount","className","onClick","expansionZoom","Math","min","getClusterExpansionZoom","panTo","map","key","Lat","Lon","v","bootstrapURLKeys","process","defaultCenter","center","defaultZoom","onChildClick","e","yesIWantToUseGoogleMapApiInternals","shouldUnregisterMapOnUnmount","onGoogleApiLoaded","setClickableIcons","onChange","nw","se","points","marker","type","properties","geometry","coordinates","parseFloat","useSupercluster","options","radius","minZoom","maxZoom","clusters","longitude","latitude","isCluster","point_count","Clusters","setRoutes","payload","Buses","useSelector","state","dispatch","useDispatch","fetchRoutes","fetchBuses","useCallback","bus","RouteStop","find","route","tripId","parseInt","Route","routeId","Line","DelayTime","abs","Delay","substr","replace","sort","b","localeCompare","coords","navigator","geolocation","getCurrentPosition","pos","crd","err","enableHighAccuracy","timeout","maximumAge","colSpan","title","VehicleCode","Speed","to","exact","component","href","rel","target","window","innerWidth","onClickMenuHide","src","logo","alt","router","activeClassName","App","path","NotFound","Boolean","location","hostname","match","initial_state","routesReducer","action","tripHeadsign","allReducers","combineReducers","store","createStore","ReactDOM","render","StrictMode","document","getElementById","serviceWorker","ready","registration","unregister","message"],"mappings":"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","file":"static/js/main.c3ee0404.chunk.js","sourcesContent":["import axios from 'axios';\r\n\r\nconst instance = axios.create({\r\n    baseURL: 'https://ckan2.multimediagdansk.pl',\r\n    // timeout: 1000,\r\n});\r\nexport default instance;","import query from './query';\r\nimport axios from 'axios'\r\n\r\nexport const getBuses = async () => {\r\n    const buses = await query.get('/gpsPositions')\r\n        .then(response => response.data.Vehicles.filter(vehicle => vehicle.GPSQuality >= 2))\r\n        .catch((error) => {\r\n            console.error(error);\r\n            return [];\r\n        }).then(res => res);\r\n    return buses;\r\n};\r\n\r\nexport const getRoutes = async () => {\r\n    const date = (new Date()).toISOString().split('T')[0];\r\n    const routes = await axios.get('https://ckan.multimediagdansk.pl/dataset/c24aa637-3619-4dc2-a171-a23eec8f2172/resource/b15bb11c-7e06-4685-964e-3db7775f912f/download/trips.json')\r\n        .then(response => response.data[date].trips)\r\n        .catch((error) => {\r\n            console.error(error);\r\n            return [];\r\n        }).then(res => res);\r\n    return routes;\r\n};\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport GoogleMapReact from 'google-map-react';\r\nimport useSupercluster from \"use-supercluster\";\r\nimport './map.scss';\r\n\r\nfunction MapContainer(props) {\r\n    const [selected, setSelected] = useState({ id: 0, hidden: false })\r\n    const [markers, setMarkers] = useState([]);\r\n    const idField = props.idField;\r\n    const refresher = useRef(null);\r\n    const mapMarker = props.mapMarker;\r\n    const MapSidebarItem = props?.mapSidebarItem;\r\n    const autoUpdate = props?.autoUpdate ?? false;\r\n    const [menu, setMenu] = useState(false);\r\n\r\n    const mapRef = useRef();\r\n    const [bounds, setBounds] = useState(null);\r\n    const [zoom, setZoom] = useState(10);\r\n\r\n    const fetchData = async () => {\r\n        let newMarkers = await props?.refreshFunc() ?? [];\r\n        if (newMarkers.length === 0) {\r\n            console.error('Fetched data from Tristar API is empty')\r\n            return;\r\n        }\r\n        setMarkers(newMarkers);\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n        if (autoUpdate) refresher.current = setInterval(() => fetchData(), autoUpdate);\r\n        // cleanup\r\n        return () => clearTimeout(refresher.current)\r\n    }, []);\r\n\r\n    const Marker = ({ item, MapMarker }) => {\r\n        const current = selected.id === item[idField] && !selected.hidden;\r\n        item.current = current;\r\n        const onClick = () => setSelected({ id: 0, hidden: true });\r\n        item.closeFunction = onClick;\r\n        return <MapMarker item={item} />\r\n    };\r\n\r\n    const Cluster = ({ lat, lng, supercluster, cluster, pointCount }) => {\r\n        const onClick = () => {\r\n            const expansionZoom = Math.min(supercluster.getClusterExpansionZoom(cluster.id), 20);\r\n            mapRef.current.setZoom(expansionZoom);\r\n            mapRef.current.panTo({ lat, lng });\r\n        };\r\n        return (<div className='marker' onClick={onClick}>\r\n            <div className=\"cluster\">\r\n                {pointCount}\r\n            </div>\r\n        </div>);\r\n    };\r\n\r\n    const onChildClick = (key, data) => {\r\n        // just to check if it's not a supercluster which doesn't have assigned idField\r\n        const supercluster = data.item?.[idField] ?? false;\r\n        if (supercluster) {\r\n            setSelected(({ id, hidden }) => {\r\n                const newId = id === data.item[idField] ? 0 : data.item[idField];\r\n                return { id: newId, hidden }\r\n            });\r\n        }\r\n        if (selected.hidden)\r\n            setSelected({ id: 0, hidden: false })\r\n    };\r\n\r\n    const onClick = e => setSelected({ id: 0, hidden: false });\r\n\r\n    const onGoogleApiLoaded = ({ map }) => {\r\n        map.setClickableIcons(false);\r\n        mapRef.current = map;\r\n    };\r\n\r\n    const Clusters = () => {\r\n        const points = markers.map(marker => ({\r\n            type: \"Cluster\",\r\n            properties: { item: { ...marker }, cluster: false },\r\n            geometry: { type: \"Point\", coordinates: [parseFloat(marker.Lon), parseFloat(marker.Lat)] }\r\n        }));\r\n\r\n        const { clusters, supercluster } = useSupercluster({ points, bounds, zoom, options: { radius: 55, minZoom: 12, maxZoom: 20 } });\r\n\r\n        const newClusters = clusters.map((cluster, key) => {\r\n            const [longitude, latitude] = cluster.geometry.coordinates;\r\n            const { cluster: isCluster, point_count: pointCount } = cluster.properties;\r\n\r\n            return isCluster ?\r\n                (<Cluster key={key} lat={latitude} lng={longitude} supercluster={supercluster} cluster={cluster} pointCount={pointCount} />) :\r\n                (<Marker key={key} lat={latitude} lng={longitude} item={cluster.properties.item} MapMarker={mapMarker} />);\r\n        });\r\n\r\n        return newClusters;\r\n    };\r\n\r\n    const onClickMenu = () => setMenu(v => !v);\r\n\r\n    return (\r\n        <div className='map'>\r\n            {MapSidebarItem &&\r\n                <div className={`map__sidebar${menu ? ' active' : ''}`}>\r\n                    <div className='map__sidebar-container'>\r\n                        {markers.map((item, key) => {\r\n                            const current = item[idField] === selected.id;\r\n                            const onClick = () => {\r\n                                setSelected({ id: item[idField], hidden: false })\r\n                                mapRef.current.setZoom(16);\r\n                                mapRef.current.panTo({ lat: item.Lat, lng: item.Lon });\r\n                            };\r\n                            return (\r\n                                <div className={`map__sidebar-item${current ? ' active' : ''}`} key={key} onClick={onClick}>\r\n                                    <MapSidebarItem item={item} />\r\n                                </div>\r\n                            );\r\n                        })}\r\n                        <div className='menu-button' onClick={onClickMenu}><span></span></div>\r\n                    </div>\r\n                </div>\r\n            }\r\n            <GoogleMapReact\r\n                bootstrapURLKeys={{ key: process.env.REACT_APP_GOOGLE_MAPS_KEY }}\r\n                defaultCenter={props.center}\r\n                defaultZoom={props.zoom}\r\n                onChildClick={onChildClick}\r\n                onClick={onClick}\r\n                yesIWantToUseGoogleMapApiInternals={true}\r\n                shouldUnregisterMapOnUnmount={true}\r\n                onGoogleApiLoaded={onGoogleApiLoaded}\r\n                onChange={({ zoom, bounds }) => {\r\n                    setZoom(zoom);\r\n                    setBounds([bounds.nw.lng, bounds.se.lat, bounds.se.lng, bounds.nw.lat]);\r\n                }}\r\n            >\r\n                {Clusters().map(item => item)}\r\n            </GoogleMapReact>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MapContainer;","export const setRoutes = ({ routes = [] }) => {\r\n    return {\r\n        type: 'ROUTES_SET',\r\n        payload: { routes },\r\n    };\r\n};","import React, { useEffect, useCallback } from 'react';\r\nimport { getBuses, getRoutes } from './../../../utils/apis';\r\nimport Map from './../../map';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { setRoutes } from './../../../actions/routes';\r\n\r\nfunction Buses(props) {\r\n    const routes = useSelector(state => state.routes)\r\n    const dispatch = useDispatch();\r\n\r\n    const fetchRoutes = async () => dispatch(setRoutes({ routes: await getRoutes() }));\r\n\r\n    useEffect(() => {\r\n        if (routes.length === 0) fetchRoutes();\r\n    }, [])\r\n\r\n    const fetchBuses = useCallback(async () => {\r\n        let buses = await getBuses();\r\n        buses = buses.map(bus => {\r\n            bus.RouteStop = routes.find(route => route.tripId === parseInt(bus.Route) && route.routeId === parseInt(bus.Line));\r\n            bus.DelayTime = (new Date(Math.abs(bus.Delay) * 1000).toISOString().substr(11, 8)).replace(/00:/, '');\r\n            return bus;\r\n        });\r\n        buses.sort((a, b) => a.Line.localeCompare(b.Line))\r\n        return buses;\r\n    }, [routes]);\r\n\r\n    let coords = { lat: 54.385561, lng: 18.600739 };\r\n    navigator.geolocation.getCurrentPosition(pos => {\r\n        const crd = pos.coords;\r\n        coords.lat = crd.latitude;\r\n        coords.lng = crd.longitude;\r\n    }, err => null, {\r\n        enableHighAccuracy: true,\r\n        timeout: 5000,\r\n        maximumAge: 0\r\n    });\r\n\r\n    const map_marker = ({ item }) => {\r\n        return (\r\n            <div className={`marker`}>\r\n                <div className=\"dot\">{item.Line}</div>\r\n                {item.current &&\r\n                    <div className='info'>\r\n                        <table className=\"table-responsive table-striped table-hover\">\r\n                            <thead className='w-100 d-table'>\r\n                                <tr>\r\n                                    <td colSpan={2} onClick={item.closeFunction}>Hide</td>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody className='w-100 d-table'>\r\n                                {item.Line && (<tr><td className='p-1'>Line</td><td className='border-left p-1 font-weight-bold'>{item.Line}</td></tr>)}\r\n                                {item.Delay !== 0 && (<tr><td className='p-1'>{item.Delay > 0 ? 'Delay' : 'Before time'}</td><td className='border-left p-1 font-weight-bold'>{item.DelayTime}</td></tr>)}\r\n                                {item.RouteStop && (<tr><td className='p-1'>Route</td><td className='border-left p-1 font-weight-bold'>{item.RouteStop.title}</td></tr>)}\r\n                                {item.VehicleCode && (<tr><td className='p-1'>Vehicle code</td><td className='border-left p-1 font-weight-bold'>{item.VehicleCode}</td></tr>)}\r\n                                {item.Speed > 0 && (<tr><td className='p-1'>Speed</td><td className='border-left p-1 font-weight-bold'>{item?.Speed} km/h</td></tr>)}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                }\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const map_sidebar_item = ({ item }) => {\r\n        return (\r\n            <div className='row no-gutters'>\r\n                <div className='col-2 col-sm-3 p-2 font-weight-bold d-flex align-items-center justify-content-center'>{item.Line}</div>\r\n                <div className='col-10 col-sm-9 p-2 font-weight-bold border-left'>{item.RouteStop && item.RouteStop.title}</div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {/* {data?.map?.((item, key) => (<div key={key}>{item.Line}, {item.VehicleId}, {item.Speed}, {item.Delay} Lat: {item.Lat}, Long: {item.Lon}</div>))} */}\r\n            <div className='vh-100' >\r\n                {routes.length > 0 && <Map center={coords} zoom={16} refreshFunc={fetchBuses} idField={'VehicleId'} autoUpdate={5000} mapMarker={map_marker} mapSidebarItem={map_sidebar_item} />}\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Buses;","import Main from './../views/Main';\r\nimport Buses from './../views/Buses';\r\n\r\nexport default [\r\n    {\r\n        to: '/',\r\n        exact: true,\r\n        component: Main,\r\n        // title: 'Main page',\r\n    },\r\n    {\r\n        to: '/buses',\r\n        component: Buses,\r\n        title: 'Buses',\r\n    }\r\n];","import React from 'react';\r\n\r\nexport default function () {\r\n    return (\r\n        <div className='p-4'>\r\n            <pre className='text-wrap text-break'>\r\n                <h2>ZTM Tracker</h2>\r\n                <p>\r\n                    Application represents ZTM data based on their API which can be found <a href='https://ckan.multimediagdansk.pl/dataset/tristar' rel=\"noopener noreferrer\" target='_blank' className='font-weight-normal'>here</a>.\r\n                </p>\r\n                <p>\r\n                    For this moment You can see current position of the vehicles like buses and trams around Gda≈Ñsk area. Each vehicle shows delay and unique vehicle code.\r\n                </p>\r\n                {/* <p>\r\n                    API currently allows only to view positions of the buses. I wrote them a email and still waiting for answer. After they fix CORS error I will develop bus and tram stops, show destination point of the vehicles and maybe something else.\r\n                </p> */}\r\n                {/* TODO */}\r\n            </pre>\r\n        </div>\r\n    );\r\n};","import React from 'react';\r\nimport Buses from '../../components/models/Buses/Buses';\r\nimport './Buses.scss';\r\n\r\nexport default function () {\r\n\r\n    return (\r\n        <div>\r\n            <Buses />\r\n        </div>\r\n    );\r\n};","export default __webpack_public_path__ + \"static/media/bus-logo.a0edf5fd.png\";","import React, { useState } from 'react';\r\nimport { NavLink, Link } from \"react-router-dom\";\r\nimport router from './../../router';\r\nimport logo from './../../assets/bus-logo.png';\r\nimport './Header.scss';\r\n\r\nexport default function () {\r\n    const [menu, setMenu] = useState(!(window.innerWidth > 768));\r\n    const onClickMenu = () => setMenu(v => !v);\r\n    const onClickMenuHide = () => setMenu(true)\r\n    return (\r\n        <header className={menu ? 'active' : ''}>\r\n            <nav>\r\n                <div className=\"nav-brand p-3\">\r\n                    <Link to='/' className='text-decoration-none' onClick={onClickMenuHide}>\r\n                        <img src={logo} alt=\"ZTM tracker\" className='img-fluid' />\r\n                        <div className='h2 text-white text-center'>ZTM tracker</div>\r\n                    </Link>\r\n                </div>\r\n                <ul className='nav flex-column'>\r\n                    {router.map(({ to, title, exact }, key) =>\r\n                        title && <NavLink\r\n                            to={to} exact key={key}\r\n                            className='nav-item text-decoration-none py-2 px-3 font-weight-normal h5 m-0'\r\n                            activeClassName='shadow active'\r\n                            onClick={onClickMenuHide}\r\n                        >{title}</NavLink>\r\n                    )}\r\n                </ul>\r\n            </nav>\r\n            <div className='menu-button' onClick={onClickMenu}><span></span></div>\r\n        </header>\r\n    );\r\n}","import React from 'react';\r\n\r\nexport default function () {\r\n    return (\r\n        <div className='p-4'>\r\n            <pre className='text-wrap'>Sorry, but we couldn't find what you have been looking for :(</pre>\r\n        </div>\r\n    );\r\n};","import React from 'react';\nimport { Route, HashRouter as Router, Switch } from \"react-router-dom\";\nimport Header from './../components/header';\nimport NotFound from '../views/NotFound';\nimport router from './../router';\nimport './App.scss';\n\n\nfunction App() {\n    return (\n        <div className=\"App min-vh-100\">\n            <Router>\n                <div className='d-flex'>\n                    <Header />\n                    <main className='min-vh-100'>\n                        <Switch>\n                            {router.map((item, key) => <Route exact={item.exact} path={item.to} key={key} component={item.component} />)}\n                            <Route component={NotFound} />\n                        </Switch>\n                    </main>\n                </div>\n            </Router>\n        </div>\n    );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","const initial_state = [];\r\n\r\nconst routesReducer = (state = initial_state, action) => {\r\n    switch (action.type) {\r\n        case \"ROUTES_SET\":\r\n            const routes = action.payload.routes.map(item => {\r\n                item.title = item.tripHeadsign.replace(/\\(\\d+\\)/g, '');\r\n                // console.log(item);\r\n                return item;\r\n            })\r\n            return routes;\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default routesReducer;","import { combineReducers } from 'redux';\r\nimport routesReducer from './routesReducer';\r\n\r\nconst allReducers = combineReducers({\r\n    routes: routesReducer,\r\n});\r\n\r\nexport default allReducers;","import { createStore } from 'redux';\r\nimport allReducers from './../reducers'\r\n\r\nconst store = createStore(allReducers);\r\n\r\nexport default store;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './app/App.js';\nimport * as serviceWorker from './serviceWorker';\nimport { Provider } from 'react-redux';\nimport store from './stores';\n\nReactDOM.render(\n    <React.StrictMode>\n        <Provider store={store}>\n            <App />\n        </Provider>\n    </React.StrictMode>,\n    document.getElementById('root')\n);\n\nserviceWorker.unregister();\n"],"sourceRoot":""}